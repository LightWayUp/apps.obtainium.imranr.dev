<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obtainium Redirect</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <link rel="icon" href="https://raw.githubusercontent.com/ImranR98/Obtainium/main/assets/graphics/icon_small.png">
    <style>
        html, body {
            height: 100%;
        }

        /* Generic styles */

        :root {
            --color-seed-rgb: 100, 56, 181;                                                 /* #6438b5 */
            --color-seed: rgb(var(--color-seed-rgb));
            --opacity-subtle: 0.25;

            /* Color values are computed with flutter/material.dart, using default Obtainium color #6438b5
               ColorScheme.fromSeed(seedColor: Color(0xFF6438B5)) */
            --bs-body-color-rgb: 29, 27, 32;                                                /* ColorScheme#onSurface */
            --bs-body-color: rgb(var(--bs-body-color-rgb));
            --bs-body-bg-rgb: 254, 247, 255;                                                /* ColorScheme#surface */
            --bs-body-bg: rgb(var(--bs-body-bg-rgb));
            --bs-border-color-rgb: 203, 196, 207;                                           /* ColorScheme#outlineVariant */
            --bs-border-color: rgb(var(--bs-border-color-rgb));
            --bs-primary-rgb: 103, 84, 142;                                                 /* ColorScheme#primary */
            --bs-primary: rgb(var(--bs-primary-rgb));
            --color-primary-offset-5-rgb: 91, 74, 125;                                      /* 5% less lightness from primary in HSL */
            --color-primary-offset-5: rgb(var(--color-primary-offset-5-rgb));
            --color-primary-offset-10-rgb: 79, 64, 109;                                     /* 10% less lightness from primary in HSL */
            --color-primary-offset-10: rgb(var(--color-primary-offset-10-rgb));
            --color-on-primary: #fff;                                                       /* ColorScheme#onPrimary */
            --bs-primary-bg-subtle: #eaddff;                                                /* ColorScheme#primaryContainer */
            --bs-primary-border-subtle: rgba(var(--bs-primary-rgb), var(--opacity-subtle));
            --bs-primary-text-emphasis: #220f46;                                            /* ColorScheme#onPrimaryContainer */
            --color-secondary-rgb: 99, 91, 112;                                             /* ColorScheme#secondary */
            --color-secondary: rgb(var(--color-secondary-rgb));
            --color-secondary-offset-10-rgb: 75, 69, 84;                                    /* 10% less lightness from secondary in HSL */
            --color-secondary-offset-10: rgb(var(--color-secondary-offset-10-rgb));
            --bs-danger-rgb: 186, 26, 26;                                                   /* ColorScheme#error */
            --bs-danger: rgb(var(--bs-danger-rgb));
            --bs-danger-bg-subtle: #ffdad6;                                                 /* ColorScheme#errorContainer */
            --bs-danger-border-subtle: rgba(var(--bs-danger-rgb), var(--opacity-subtle));
            --bs-danger-text-emphasis: #410002;                                             /* ColorScheme#onErrorContainer */
            --bs-info: var(--bs-primary);
            --bs-info-bg-subtle: var(--bs-primary-bg-subtle);
            --bs-info-border-subtle: var(--bs-primary-border-subtle);
            --bs-info-text-emphasis: var(--bs-primary-text-emphasis);
        }

        .btn-primary {
            --bs-btn-color: var(--color-on-primary);
            --bs-btn-bg: var(--bs-primary);
            --bs-btn-border-color: var(--bs-primary-border-subtle);
            --bs-btn-hover-color: var(--color-on-primary);
            --bs-btn-hover-bg: var(--color-primary-offset-5);
            --bs-btn-hover-border-color: rgba(var(--color-primary-offset-5-rgb), var(--opacity-subtle));
            --bs-btn-active-color: var(--color-on-primary);
            --bs-btn-active-bg: var(--color-primary-offset-10);
            --bs-btn-active-border-color: rgb(var(--color-primary-offset-10-rgb), var(--opacity-subtle));
            --bs-btn-disabled-color: var(--bs-btn-color);
            --bs-btn-disabled-bg: var(--bs-btn-bg);
            --bs-btn-disabled-border-color: var(--bs-btn-border-color);
        }

        a {
            --bs-link-color-rgb: var(--bs-primary-rgb);
            --bs-link-color: rgb(var(--bs-link-color-rgb));
            --bs-link-hover-color-rgb: var(--color-primary-offset-10-rgb);
            --bs-link-hover-color: rgb(var(--bs-link-hover-color-rgb));
            --bs-link-underline-opacity: 0.5;
            text-decoration-color: rgba(var(--bs-link-color-rgb), var(--bs-link-underline-opacity, 1));
        }

        .link-primary {
            --bs-link-underline-opacity: revert;
            color: rgba(var(--bs-link-color-rgb), var(--bs-link-opacity, 1)) !important;
            text-decoration-color: rgba(var(--bs-link-color-rgb), var(--bs-link-underline-opacity, 1)) !important;
        }

        .link-primary:focus, .link-primary:hover {
            color: rgba(var(--bs-link-hover-color-rgb), var(--bs-link-opacity, 1)) !important;
            text-decoration-color: rgba(var(--bs-link-hover-color-rgb), var(--bs-link-underline-opacity, 1)) !important;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                /* Color values are computed with flutter/material.dart, using default Obtainium color #6438b5
                   ColorScheme.fromSeed(seedColor: Color(0xFF6438B5), brightness: Brightness.dark) */
                --bs-body-color-rgb: 231, 224, 232;                                         /* ColorScheme#onSurface */
                --bs-body-bg-rgb: 21, 18, 24;                                               /* ColorScheme#surface */
                --bs-border-color-rgb: 73, 69, 78;                                          /* ColorScheme#outlineVariant */
                --bs-primary-rgb: 210, 188, 253;                                            /* ColorScheme#primary */
                --color-primary-offset-5-rgb: 225, 210, 254;                                /* 5% more lightness from primary in HSL */
                --color-primary-offset-10-rgb: 242, 235, 254;                               /* 10% more lightness from primary in HSL */
                --color-on-primary: #38265c;                                                /* ColorScheme#onPrimary */
                --bs-primary-bg-subtle: #4f3d74;                                            /* ColorScheme#primaryContainer */
                --bs-primary-text-emphasis: #eaddff;                                        /* ColorScheme#onPrimaryContainer */
                --color-secondary-rgb: 205, 194, 219;                                       /* ColorScheme#secondary */
                --color-secondary-offset-10-rgb: 231, 226, 238;                             /* 10% more lightness from secondary in HSL */
                --bs-danger-rgb: 255, 180, 171;                                             /* ColorScheme#error */
                --bs-danger-bg-subtle: #93000a;                                             /* ColorScheme#errorContainer */
                --bs-danger-text-emphasis: #ffdad6;                                         /* ColorScheme#onErrorContainer */
            }
        }

        /* Application-specific styles */

        #redirectBtn {
            --bs-btn-padding-x: 20px;
            --bs-btn-padding-y: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);                                        /* ColorScheme#shadow */
        }
    </style>
</head>
<body class="d-flex justify-content-center align-items-center">
    <div class="container text-center">
        <noscript>
            <div class="alert alert-danger">Enable JavaScript in your browser to redirect to Obtainium.</div>
        </noscript>
        <div id="error" class="alert alert-danger" hidden=""></div>
        <div hidden="">
            <div id="redirecting" class="alert alert-info mt-5">
                <h3 class="m-3">Redirecting to Obtainium…</h3>
                <button id="redirectBtn" class="btn btn-primary btn-lg m-3">Click here if you are not redirected</button>
            </div>
            <div id="appLink" class="mt-5">
                Don't have Obtainium? Visit <span id="appName">the app's</span> home page <a id="appLinkHref" href="#" class="link-primary">here</a>.
            </div>
            <div id="downloadLink" class="mt-5">
                OR, <a href="https://github.com/ImranR98/Obtainium/releases/latest" class="link-primary">download Obtainium here</a>.
            </div>
            <div id="homeLink" class="mt-5">
                OR, <a href="/">browse the full app list here</a>.
            </div>
        </div>
    </div>
    <script>
        window.onload = function() {
            var urlParams = new URLSearchParams(window.location.search);
            var redirectUrl = urlParams.get('r');
            if (redirectUrl && (redirectUrl.startsWith('obtainium://app/') || redirectUrl.startsWith('obtainium://add/'))) {
                try {
                    var appData = {};
                    if (redirectUrl.startsWith('obtainium://app/')) {
                        appData = JSON.parse(decodeURIComponent(redirectUrl.replace('obtainium://app/', '')));
                        redirectUrl = "obtainium://app/" + encodeURIComponent(JSON.stringify(appData));
                    } else if (redirectUrl.startsWith('obtainium://add/')) {
                        appData.url = decodeURIComponent(redirectUrl.replace('obtainium://add/', ''));
                        var urlPattern = new RegExp('^(http://|https://)');
                        if (!urlPattern.test(appData.url)) {
                            throw new Error;
                        }
                        redirectUrl = "obtainium://add/" + appData.url;
                    }
                    document.getElementById('redirecting').style.display = 'block';
                    window.location.href = redirectUrl;
                    document.getElementById('redirectBtn').onclick = function() {
                        window.location.href = redirectUrl;
                    };
                    document.getElementById('appLink').style.display = 'block';
                    document.getElementById('downloadLink').style.display = 'block';
                    document.getElementById('homeLink').style.display = 'block';
                    var appLinkHref = document.getElementById('appLinkHref');
                    appLinkHref.href = appData.url;
                    if (appData.name) {
                        document.getElementById('appName').textContent = appData.name + "'s";
                    }
                } catch (e) {
                    document.getElementById('error').style.display = 'block';
                    document.getElementById('error').textContent = 'Invalid URL. Valid app URL could not be found.';
                }
            } else {
                document.getElementById('error').style.display = 'block';
                document.getElementById('error').textContent = 'Invalid URL. Redirect should be provided and start with "obtainium://add/" or "obtainium://app/".';
            }
        };
    </script>
</body>
<!-- TODO: Localizations

de: {
    title: Weiterleitungsseite zu Obtainium
    no script: Aktiviere Java-Skript in deinem Browser, um zu Obtanium weitergeleitet zu werden.
    redirecting: Weiterleitung zu Obtainium…
    click to redirect: Klicke hier, wenn du noch nicht weitergeleitet wurdest
    don't have Obtainium: Hast du noch nicht Obtainium?
    visit URL: Besuche ${appName} ${appLinkHref},
    appName: unsere
    appLinkHref: home page
    download Obtainium: oder ${obtainiumHref},
    obtainiumHref: lade Obtainium hier herunter
    all app configurations: oder ${indexHref}.
    indexHref: durchsuche unsere App-Konfigurationsliste
    invalid obtainium://add/ URL: Invalide URL. Keine valide URL gefunden.
    no query parameter: Invalide URL. Eine Umleitung sollte, startend mit "obtainium://add/" oder "obtainium://app/", eingerichtet werden.
}

-->
</html>
